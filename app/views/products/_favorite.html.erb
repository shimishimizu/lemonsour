<% if user_signed_in? %>

  <% unless product.favorite_user(current_user.id).blank? %>
    <%= link_to product_favorite_path(product_id: product.id ,id: product.favorites[0].id), method: :delete, remote: true do %>
      <div class="vertical_favorite">
        <i class="heart-icon fa fa-heart" aria-hidden="true" style="color: red;"></i>
        <span class="red-text">
        	<%= link_to product_users_path(@product.id) do %>
          <%= product.favorites_count %>
          <% end %>
        </span>
      </div>
    <% end %>
  <% else %>
    <%= link_to product_favorites_path(product.id), method: :post, remote: true do %>
      <div class="vertical_favorite">
        <i class="heart-icon far fa-heart" aria-hidden="true"></i>
        <span class="grey-text text-darken-2">
          <%= product.favorites_count %>
        </span>
      </div>
    <% end %>
  <% end %>

<% else %>

  <% if product.favorites_count > 0 %>
    <div class="vertical_favorite">
      <i class="heart-icon fa fa-heart" aria-hidden="true" style="color: red;"></i>
      <span class="red-text">
        <%= product.favorites_count %>
      </span>
    </div>
  <% else %>
    <div class="vertical_favorite">
      <i class="heart-icon far fa-heart" aria-hidden="true">favorite_border</i>
      <span class="grey-text text-darken-2">
        <%= product.favorites_count %>
      </span>
    </div>
  <% end %>

<% end %>